<!doctype html><html lang=en-us dir=ltr><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This work is made by Andrei Markov and Nikita Bogdankov
Grad-CAM # What is it? # Grad-CAM (Gradient-weighted Class Activation Mapping) is a technique used in deep learning, particularly with convolutional neural networks (CNNs), to understand which regions of an input image are important for the network&rsquo;s prediction of a particular class.
This method can be used for understanding how a CNN has been driven to make a final classification decision."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:url" content="http://localhost:1313/docs/groups/gradcam/"><meta property="og:site_name" content="XAI"><meta property="og:title" content="XAI"><meta property="og:description" content="This work is made by Andrei Markov and Nikita Bogdankov
Grad-CAM # What is it? # Grad-CAM (Gradient-weighted Class Activation Mapping) is a technique used in deep learning, particularly with convolutional neural networks (CNNs), to understand which regions of an input image are important for the networkâ€™s prediction of a particular class.
This method can be used for understanding how a CNN has been driven to make a final classification decision."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="docs"><title>Grad Cam | XAI</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.e832d4e94212199857473bcf13a450d089c3fcd54ccadedcfac84ed0feff83fb.css integrity="sha256-6DLU6UISGZhXRzvPE6RQ0InD/NVMyt7c+shO0P7/g/s=" crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/mathtex-script-type.min.js integrity=sha384-jiBVvJ8NGGj5n7kJaiWwWp9AjC+Yh8rhZY3GtAX8yU28azcLgoRo4oukO87g7zDT crossorigin=anonymous></script><script defer src=/flexsearch.min.js></script><script defer src=/en.search.min.690e50761b66b2e4cf12ec5df41f0c40cac7f8b58f42e8845ad4158a9deab588.js integrity="sha256-aQ5QdhtmsuTPEuxd9B8MQMrH+LWPQuiEWtQVip3qtYg=" crossorigin=anonymous></script><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js integrity="sha256-b2+Q/LjrHEnsOJg45rgB0N4ZQwuOUWkC+NdcPIvZhzk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><img src=/YELLOW_BAR.png alt=Logo><span><b>XAI</b></span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/docs/groups/cam_and_secam/>CAM and SeCAM</a></li><li><a href=/docs/groups/diffusion-lens-interpreting-text-encoders-in-text-to-image-pipelines-tuned-using-dreambooth/>Diffusion Lens: Interpreting Text Encoders in Text-to-Image pipelines</a></li><li><a href=/docs/groups/dimensionality-reduction-in-nlp-visualizing-sentence-embeddings-with-umap-and-t-sne/>Dimensionality Reduction in NLP: Visualizing Sentence Embeddings with UMAP and t-SNE</a></li><li><a href=/docs/groups/example/>Example</a></li><li><a href=/docs/groups/ai-playing-geoguessr-explained/>Ai Playing Geo Guessr Explained</a></li><li><a href=/docs/groups/contrastive-grad-cam-consistency/>Contrastive Grad Cam Consistency</a></li><li><a href=/docs/groups/dndfs_shap/>Dndfs Shap</a></li><li><a href=/docs/groups/gradcam/ class=active>Grad Cam</a></li><li><a href=/docs/groups/integrated-gradients/>Integrated Gradients</a></li><li><a href=/docs/groups/kernel-shap/>Kernel Shap</a></li><li><a href=/docs/groups/rag/>Rag</a></li><li><a href=/docs/groups/shap_darya_and_viktoria/>Shap Darya and Viktoria</a></li><li><a href=/docs/groups/sverl_tac_toe/>Sverl Tac Toe</a></li><li><a href=/docs/groups/torchprism/>Torch Prism</a></li><li><a href=/docs/groups/xai_for_transformers/>Xai for Transformers</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Grad Cam</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#grad-cam>Grad-CAM</a><ul><li><a href=#what-is-it>What is it?</a></li><li><a href=#how-does-it-work>How does it work?</a></li><li><a href=#where-can-it-be-used>Where can it be used?</a></li></ul></li></ul></nav></aside></header><article class=markdown><p>This work is made by <strong>Andrei Markov</strong> and <strong>Nikita Bogdankov</strong></p><h1 id=grad-cam>Grad-CAM
<a class=anchor href=#grad-cam>#</a></h1><h2 id=what-is-it>What is it?
<a class=anchor href=#what-is-it>#</a></h2><p><strong>Grad-CAM</strong> (Gradient-weighted Class Activation Mapping) is a technique used in deep learning, particularly with convolutional neural networks (CNNs), to understand which regions of an input image are important for the network&rsquo;s prediction of a particular class.</p><p><img src=/GradCAM/example4.png alt=image></p><p>This method can be used for understanding how a CNN has been driven to make a final classification decision. Grad-CAM is class-specific, which means that it can produce a separate visualizations on the image for each class. If happens that there is a classification error, than Grad-CAM can help you to see what it did wrong, so we can say that it makes the algorithm more transparent to the developers.</p><p>Grad-CAM consists of producing heatmaps which show the activation classes on the input images. Each activation class is associated with one of the output classes, which are used to indicate the importance of each pixel to the question by changing the intensity of the pixel.</p><p><img src=/GradCAM/example6.png alt=image></p><p>On the picture above you can see how important objects for detection are highlighted on the image. And after we created heatmap, we should overlay image and this heatmap to get the final result.</p><h2 id=how-does-it-work>How does it work?
<a class=anchor href=#how-does-it-work>#</a></h2><p>Now let&rsquo;s see get to how Grad-CAM works. I will give you a step-by-step explanation:</p><ol><li><strong>Forward Pass</strong> - First, let
<link rel=stylesheet href=/katex/katex.min.css><script defer src=/katex/katex.min.js></script><script defer src=/katex/auto-render.min.js onload=renderMathInElement(document.body)></script><span>\(A^{k}\)
</span>be the activation map. It is passed through the subsequent layers of the neural network to compute the final class score <span>\(y_{c}\)
</span>for the target class <span>\(c\)
</span>. <span>\[y_{c}=\sum_iw_{i}^c\cdot A_i\]
</span>where <span>\(w_{i}^c\)
</span>represents the weight of the <span>\({i}\)
</span>th feature map <span>\(A_i\)
</span>for the class <span>\(c\)
</span>.</li><li><strong>Backpropagation</strong> - The gradients of the class score <span>\(y_c\)
</span>with respect to the activation map <span>\(A_k\)
</span>are computed using backpropagation: <span>\[\dfrac{\partial y_c}{\partial A^{k}}\]</span></li><li><strong>Gradient Weighting</strong> - Grad-CAM assigns importance weights to each activation map based on the gradients gained in the backpropagation step. This is done by taking Global Average Pooling of the gradients: <span>\[\alpha_{k}^{c}= \dfrac{1}{Z} \sum_{i} \sum_{j} \dfrac {\partial y_c}{\partial A_{ij}^{k}}\]
</span><span>\(\alpha_{k}^{c}\)
</span>is the importance weight and <span>\(Z\)
</span>is the spatial dimension of the activation map. <span>\(i\)
</span>and <span>\(j\)
</span>are width and height dimensions, <span>\(y_c\)
</span>is class score(before softmax).</li><li><strong>Heatmap Generation</strong> - Grad-CAM generates the heatmap <span>\(H_c\)
</span>by linearly combining the activation maps weighted by their importance scores: <span>\[H^{c} =ReLU (\sum_k \alpha_{k}^{c} A^{k})\]
</span>where <span>\(ReLU\)
</span>is the rectified linear unit activation function, allowing only positive values contribute to the heatmap.
Heatmap <span>\(H_c\)
</span>highlights the regions in the input image that are most relevant for the network&rsquo;s decision for the target class <span>\(c\)
</span>. Brighter the region, more it contributes to the prediction.
<img src=/GradCAM/example.png alt=image></li></ol><p>To clarify the process, I will attach the image explaining the described above:
<img src=/GradCAM/example2.png alt=image></p><h2 id=where-can-it-be-used>Where can it be used?
<a class=anchor href=#where-can-it-be-used>#</a></h2><p>But now let&rsquo;s talk about where Grad-CAM can be used. There are many fields, where it can be useful, so here are some examples:</p><ul><li><p><strong>Medical Image Analysis</strong> - Grad-CAM can help clinicians to quicker check the patients to see if there are any problems. If so, it shows where the problems may be located.
<img src=/GradCAM/example3.png alt=image></p></li><li><p><strong>Autonomous Vehicles</strong> - Grad-CAM is used for object detection, lane detection, and pedestrian recognition. It can be used to visualize which parts of the input image are most relevant in the decision-making process of these systems.
<img src=/GradCAM/example5.png alt=image></p></li><li><p><strong>Security and Surveillance</strong>: Grad-CAM is used for activity recognition, intruder detection, and object tracking. It can help security personnel to notice the criminal action if they missed it for some reason.</p></li><li><p><strong>Industrial Quality Control</strong> - Grad-CAM is used for defect detection, product classification, and quality assessment. Grad-CAM can help operators to faster detect problem details.</p></li><li><p><strong>Remote Sensing and Earth Observation</strong> - Grad-CAM is used for land cover classification, crop monitoring, and disaster detection. Grad-CAM can assist analysts in understanding which features in satellite or aerial imagery are indicative of certain land cover types or environmental conditions, aiding in resource management and disaster response.</p></li></ul><p><a href=https://colab.research.google.com/drive/13_q6BGlqTJb8gSqpUwhec2JoMhrmqLgU>Link to collab</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/IU-PR/Capstone_project/tree/master//content/docs/Groups/GradCAM.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#grad-cam>Grad-CAM</a><ul><li><a href=#what-is-it>What is it?</a></li><li><a href=#how-does-it-work>How does it work?</a></li><li><a href=#where-can-it-be-used>Where can it be used?</a></li></ul></li></ul></nav></div></aside></main></body></html>